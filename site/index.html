<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Formulário de Cadastro</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
<body>
  <div class="container mt-5">
    <h2>Formulário de Cadastro</h2>
    <form id="cadastroForm">
      <div class="form-group">
        <label for="nome">Nome:</label>
        <input type="text" class="form-control" id="nome" required>
      </div>
      <div class="form-group">
        <label for="sobrenome">Sobrenome:</label>
        <input type="text" class="form-control" id="sobrenome" required>
      </div>
      <div class="form-group">
        <label for="cpf">CPF:</label>
        <input type="text" class="form-control" id="cpf" pattern="\d{3}\.\d{3}\.\d{3}-\d{2}" maxlength="14" required>
        <small>Formato: 999.999.999-99</small>
      </div>
      <div class="form-group">
        <label for="email">Email:</label>
        <input type="email" class="form-control" id="email" required>
      </div>
      <div class="form-group">
        <label for="endereco">Endereço:</label>
        <input type="text" class="form-control" id="endereco" required>
      </div>
      <div class="form-group">
        <label for="cep">CEP:</label>
        <input type="text" class="form-control" id="cep" pattern="\d{5}-\d{3}" maxlength="9" required>
        <small>Formato: 99999-999</small>
      </div>
      <div class="form-group">
        <label for="faixaEtaria">Faixa Etária:</label><br>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" name="faixaEtaria" id="bebe" value="bebe">
          <label class="form-check-label" for="bebe">0-5</label>
        </div>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" name="faixaEtaria" id="crianca" value="crianca">
          <label class="form-check-label" for="crianca">6-12</label>
        </div>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" name="faixaEtaria" id="adolescente" value="adolescente">
          <label class="form-check-label" for="adolescente">13-18</label>
        </div>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" name="faixaEtaria" id="adulto" value="adulto">
          <label class="form-check-label" for="adulto">19-60</label>
        </div>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" name="faixaEtaria" id="idoso" value="idoso">
          <label class="form-check-label" for="idoso">61-100</label>
        </div>
      </div>
      <div class="form-group">
        <label for="sexo">Sexo:</label><br>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" name="sexo" id="masculino" value="masculino">
          <label class="form-check-label" for="masculino">Masculino</label>
        </div>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" name="sexo" id="feminino" value="feminino">
          <label class="form-check-label" for="feminino">Feminino</label>
        </div>
      </div>
      <div class="form-group">
        <label for="raca">Raça:</label>
        <select class="form-control" id="raca">
          <option value="branco">Branco</option>
          <option value="amarelo">Amarelo</option>
          <option value="negro">Negro</option>
          <option value="indigena">Indígena</option>
        </select>
      </div>
      <button type="submit" class="btn btn-primary">Gravar</button>
      <button type="button" class="btn btn-danger" onclick="apagarCadastro()">Apagar</button>
    </form>
    <div class="mt-5" id="cadastrosSalvos">
      <h3>Cadastros Salvos:</h3>
      <ul id="cadastrosList"></ul>
    </div>
  </div>

  <div class="container mt-5">
    <h2>Gráficos de Pizza</h2>
    <div class="row">
      <div class="col-md-4">
        <h4>Sexo</h4>
        <div id="<link>sexoChart</link>"></div>
      </div>
      <div class="col-md-4">
        <h4>Faixa Etária</h4>
        <div id="<link>faixaEtariaChart</link>"></div>
      </div>
      <div class="col-md-4">
        <h4>Raça</h4>
        <div id="<link>racaChart</link>"></div>
      </div>
    </div>
  </div>


  <script src="https://cdn.jsdelivr.net/npm/apexcharts@3.20.0/dist/apexcharts.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/js/bootstrap.min.js"></script>
  <script>
    var cadastros = [];

    document.getElementById("cadastroForm").addEventListener("submit", function(event) {
      event.preventDefault();
      var nome = document.getElementById("nome").value;
      var sobrenome = document.getElementById("sobrenome").value;
      var cpf = document.getElementById("cpf").value;
      var email = document.getElementById("email").value;
      var endereco = document.getElementById("endereco").value;
      var cep = document.getElementById("cep").value;
      var faixaEtaria = document.querySelector('input[name="faixaEtaria"]:checked').value;
      var sexo = document.querySelector('input[name="sexo"]:checked').value;
      var raca = document.getElementById("raca").value;

      if (cpf.length !== 14) {
        alert("Por favor, insira um CPF válido com 11 dígitos.");
        return;
      }

      if (cep.length !== 9) {
        alert("Por favor, insira um CEP válido com 8 dígitos.");
        return;
      }

      var cadastro = {
        nome: nome,
        sobrenome: sobrenome,
        cpf: cpf,
        email: email,
        endereco: endereco,
        cep: cep,
        faixaEtaria: faixaEtaria,
        sexo: sexo,
        raca: raca
      };

      cadastros.push(cadastro);
      exibirCadastros();

      document.getElementById("cadastroForm").reset();
    });

    function exibirCadastros() {
      var cadastrosList = document.getElementById("cadastrosList");
      cadastrosList.innerHTML = "";

      cadastros.forEach(function(cadastro) {
        var listItem = document.createElement("li");
        listItem.textContent = "Nome: " + cadastro.nome + " " + cadastro.sobrenome + ", CPF: " + cadastro.cpf + ", Email: " + cadastro.email + ", Endereço: " + cadastro.endereco + ", CEP: " + cadastro.cep + ", Faixa Etária: " + cadastro.faixaEtaria + ", Sexo: " + cadastro.sexo + ", Raça: " + cadastro.raca;
        cadastrosList.appendChild(listItem);
      });
      
      if (cadastros.length >= 10) {
        document.getElementById("cadastroForm").style.display = "none";
      }
    }

    function apagarCadastro() {
      cadastros = [];
      exibirCadastros();
      document.getElementById("cadastroForm").style.display = "block";
    }

     // Opções do gráfico
    var options = {
      chart: {
        type: 'pie'
      },
      labels: [],
      series: [],
      responsive: [{
        breakpoint: 480,
        options: {
          chart: {
            width: 200
          },
          legend: {
            position: 'bottom'
          }
        }
      }]
    };

    // Criar gráfico de pizza
    var sexoChart = new ApexCharts(document.querySelector("#<link>sexoChart</link>"), options);
    sexoChart.updateSeries(sexo.series);
    sexoChart.updateOptions({labels: sexo.labels});

    var faixaEtariaChart = new ApexCharts(document.querySelector("#<link>faixaEtariaChart</link>"), options);
    faixaEtariaChart.updateSeries(faixaEtaria.series);
    faixaEtariaChart.updateOptions({labels: faixaEtaria.labels});

    var racaChart = new ApexCharts(document.querySelector("#<link>racaChart</link>"), options);
    racaChart.updateSeries(raca.series);
    racaChart.updateOptions({labels: raca.labels});

    sexoChart.render();
    faixaEtariaChart.render();
    racaChart.render();
    
  </script>
</body>
</html>
